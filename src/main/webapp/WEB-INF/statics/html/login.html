<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.css">
    <script src="https://apps.bdimg.com/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="https://apps.bdimg.com/libs/jquerymobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
    <script type="text/javascript" src="../js/jquery-1.10.2.min.js"></script>
    <title>ShareOperate</title>
</head>
<body>
<div data-role="page" class="my_login">
    <div data-role="content" class="ui-content">
        <form>
            <!--输入用户名和密码-->
            <div class="my_input">
                <label for="username"></label>
                <input type="text" maxlength="11" autocomplete="off" placeholder="请输入账号" id="username">
                <span id="loginTip">&nbsp </span>
            </div>
            <div class="my_input">
                <label for="password"></label>
                <input type="password" class="input" maxlength="16" autocomplete="off" placeholder="请输入密码"
                       id="password">
                <span id="passwordTip">&nbsp </span>
            </div>
            <!--<div><a id="my_forgot" href="javascript:;" onclick="#" target="_blank">忘记密码？</a>-->
            <!--&lt;!&ndash;href="javascript:;  删除a的默认跳转&ndash;&gt;-->
            <!--</div>-->
            <!--登录注册按钮-->
            <div class="my_button">
                <input type="button" value="登录" data-inline="true" onclick="login()" data-transition="slide">
                <input type="button" value="注册" data-inline="true" onclick="window.location='SignUp.html'">
            </div>
        </form>
    </div>
</div>
<div id="my_footer">
</div>
</div>
<link rel="stylesheet" href="../css/login.css" type="text/css"/>

<script type="text/javascript">

    var FLAG = false;//密码验证通过与否标志位
    $(document).ready(function () {
        //前台验证账号
        $("#username").focus(function () {
            $("#loginTip").text("*账号由11位手机号组成");
            $("#loginTip").css("color", "red");
        })
        $("#username").blur(function () {
            var username = $("#username").val();
            if (username == "" || username == null) {
                $("#loginTip").text("*输入的用户名不能为空");
                $("#loginTip").css("color", "red");

                return false;
            } else if (!isPoneAvailable(username)) {
                $("#loginTip").text("*请输入正确的用户名");
                $("#loginTip").css("color", "red");
                return false;
            } else {
                $("#loginTip").html("<br>");
                FLAG = true;

            }
        })
        //前台验证密码
        $("#password").focus(function () {
            $("#passwordTip").text("*密码由不少于6位或大于16位数字和字母组成");
            $("#passwordTip").css("color", "red");
        })
        $("#password").blur(function () {
            // console.log("111")
            var password = $("#password").val();
            if (password == "" || password == null) {
                // console.log("222")
                $("#passwordTip").text("*输入的密码不能为空");
                $("#passwordTip").css("color", "red");
                return false;
            } else if (!CheckPassWord(password)) {
                // console.log("333")
                $("#passwordTip").text("*请输入正确的密码");
                $("#passwordTip").css("color", "red");
                return false;
            } else {
                // console.log("444")
                $("#passwordTip").html("<br>");
                FLAG = true;

            }

        })


    });

    //验证是否为11位有效手机号
    function isPoneAvailable(str) {
        var myreg = /^[1][3,4,5,7,8][0-9]{9}$/;
        if (!myreg.test(str)) {
            return false;
        } else {
            return true;
        }
    }

    //验证密码不能包括特殊字符，由数字和字母组成且长度不小于6
    function CheckPassWord(password) {
        var str = password;
        if (str == null || str.length < 6) {
            return false;
        }
        var reg1 = new RegExp(/^[0-9A-Za-z]+$/);
        if (!reg1.test(str)) {
            return false;
        }
        var reg = new RegExp(/[A-Za-z].*[0-9]|[0-9].*[A-Za-z]/);
        if (reg.test(str)) {
            return true;
        } else {
            return true;
        }
    }


    function login() {
        if (FLAG != false) {
            var username = $("#username").val();
            var password = $("#password").val();

            $.ajax({
                type: "post",
                url: "/share/login.form?name=" + username.trim() + "&pwd=" + password.trim(),
                dataType: "html",
                success: function (msg) {
                    switch (msg) {
                        case "2":
                            alert("该用户已经登录");
                            break;
                        case "1":
                            window.location.href = 'FirstPage.html';
                            break;
                        case "0":
                            alert("用户名或者密码错误");
                            break;
                        default:
                            alert("输入有误");
                    }
                }
            })
        }
        else {

        }
    }


</script>
</body>
</html>


